<!--
  @description       : 
  @author            : Marian Lyzhychka
  @group             : 
  @last modified on  : 07-02-2023
  @last modified by  : Marian Lyzhychka
-->
<template>
    <!-- <lightning-card variant="Narrow" title="Search Products" icon-name="standard:products"> -->

        <div style="width: 170%; ">
            <div class="slds-p-horizontal_small"> <!-- Header-->
                <c-product-list-view-header-c-m-p onselected={handleHeaderFilterEvent} onmassedit={handleMassEditMode}></c-product-list-view-header-c-m-p>
            </div>

            <div class="slds-p-horizontal_small main-div" style="margin-top: 10px;" > <!-- Main -->
                <div style="width: 19%; "> <!-- Left Filter Bar -->
                    <c-product-list-view-left-bar-c-m-p 
                    onfamilychange={handleRightBarFilterEvent}
                    oncategorychange={handleRightBarFilterEvent}
                    onsubcategorychange={handleRightBarFilterEvent}
                    ></c-product-list-view-left-bar-c-m-p>
                </div>
                <div style="width: 15px;"></div>
                <div style="width: 150%; "> <!-- Right Datatable -->
                    <article class="slds-card" style="border: 1px solid #D4D4D4; border-top: 3px solid #00c0ff !important;">
                        <div class="slds-card__header slds-grid">
                            <header class="slds-media slds-media_center slds-has-flexi-truncate">
                                <div class="slds-media__figure">
                                    <span class="slds-icon_container slds-icon-standard-account" title="account">
                                        <lightning-icon icon-name="standard:product_item" alternative-text="Search" title="Search"></lightning-icon>
                                    <span class="slds-assistive-text">account</span>
                                </span>
                                </div>
                                <div class="slds-media__body">
                                    <h2 class="slds-card__header-title">
                                        <a href="#" class="slds-card__header-link slds-truncate" title="Search">
                                            <span>Products List</span>
                                        </a>
                                    </h2>
                                </div>
                            </header>
                            
                            
                        </div>
                
                        <template if:true={isMassEditMode}>
                            <div class="mass-edit-message">
                                <lightning-icon icon-name="utility:warning" size="medium" class='yellow-utility-icon' ></lightning-icon>
                                <p>You are in Mass Edit Mode. Select products what you want to update, and click "Select" button. To exit from Mass Edit mode, click "Mass Edit" button.</p>
                            </div>
                        </template>


                        <div class="slds-card__body slds-card__body_inner header_main">
                            <template if:true={isSpinnerShowing}>
                                <div class="outer-div" style="height: 400px; position:relative">
                                    <lightning-spinner alternative-text="Loading" variant="brand" size="large" class="spinner">
                                    </lightning-spinner>
                                </div>
                            </template>
                            <!-- Product Datatable -->
                            <template if:true={dataIsReady}>

                                

                                
                                <div class="table-btns">
                                    <template if:false={isAddingMode}>
                                        <div>
                                            <lightning-button label="Select" onclick={selectHandler}></lightning-button>
                                        </div>
                                    </template>
                                    <div>
                                        <lightning-combobox value={pageSizePicklistValue} options={pageSizePicklistOptions} onchange={handlePageSizeChange}></lightning-combobox>
                                    </div>

                                    <div>
                                        <lightning-button-group>
                                            
                                            <lightning-button-icon icon-name="utility:jump_to_left" onclick={firstPage} ></lightning-button-icon>
                                            <lightning-button-icon icon-name="utility:chevronleft" onclick={previousPage} disabled={disablePrevious}></lightning-button-icon>


                                            <div class="records-info">
                                                <b>
                                                    {fromDisplayedRecords} - {displayedRecords} of {totalRecords}
                                                </b>
                                            </div>

                                            <lightning-button-icon icon-name="utility:chevronright" onclick={nextPage} disabled={disableNext}></lightning-button-icon>
                                            <lightning-button-icon icon-name="utility:jump_to_right" onclick={lastPage} ></lightning-button-icon>
                                            <lightning-button label="Refresh" onclick={refresh} ></lightning-button>
                                        </lightning-button-group>
                                    </div>
                                </div>

                                <template if:true={isEditMode}>
                                    <div class="table-btns" style="background: rgb(214,241,255);
                                    background: linear-gradient(90deg, rgba(214,241,255,1) 22%, rgba(9,140,182,0.7343531162464986) 66%, rgba(0,228,255,1) 100%);">
                                        <lightning-button label="SAVE" onclick={saveUpdateChanges} ></lightning-button>
                                    </div>
                                </template>
                                
                                <c-salesforce-codex-data-table
                                                key-field="Id"
                                                data={data}
                                                show-row-number-column="false"
                                                hide-checkbox-column={isAddingMode}
                                                columns={columns}
                                                default-sort-direction={defaultSortDirection}
                                                sorted-direction={sortDirection}
                                                sorted-by={sortedBy}
                                                onsort={onHandleSort}
                                                onrowaction={callRowAction}
                                                onpicklistselect={handlePicklistChange}
                                                oncellchange={handlePicklistChange}
                                                >
                                </c-salesforce-codex-data-table>


                                <div class="table-btns">
                                    <template if:false={isAddingMode}>
                                        <div>
                                            <lightning-button label="Select" onclick={selectHandler}></lightning-button>
                                        </div>
                                    </template>
                                    <div>
                                        <lightning-combobox value={pageSizePicklistValue} options={pageSizePicklistOptions} onchange={handlePageSizeChange}></lightning-combobox>
                                    </div>

                                    <div>
                                        <lightning-button-group>
                                            <lightning-button-icon icon-name="utility:jump_to_left" onclick={firstPage} ></lightning-button-icon>
                                            <lightning-button-icon icon-name="utility:chevronleft" onclick={previousPage} disabled={disablePrevious}></lightning-button-icon>


                                            <div class="records-info">
                                                <b>
                                                    {fromDisplayedRecords} - {displayedRecords} of {totalRecords}
                                                </b>
                                            </div>

                                            <lightning-button-icon icon-name="utility:chevronright" onclick={nextPage} disabled={disableNext}></lightning-button-icon>
                                            <lightning-button-icon icon-name="utility:jump_to_right" onclick={lastPage} ></lightning-button-icon>
                                        </lightning-button-group>
                                    </div>
                                </div>
                            </template>
                            

                        </div>

                        
                    </article>


                    
                </div>
            </div>
        </div>
        
        <c-products-mass-edit-c-m-p></c-products-mass-edit-c-m-p>
        <c-add-product-c-m-p></c-add-product-c-m-p>
</template>